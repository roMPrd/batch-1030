

let classmates = [
  { "name": "Romain Delimal",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1671031692/dw3o8ajav5rtu8jpgwsx.jpg",
    "github_url": "https://github.com/romprd",
    "linkedin_url": "https://www.linkedin.com/in/romain-delimal/",
    "contributions": "",
  },

  { "name": "Mario Aouane",
    "photo_url": "https://avatars.githubusercontent.com/u/115270856?v=4",
    "github_url": "https://github.com/Mario-dev-42",
    "linkedin_url": "",
    "contributions": "",
  },

  { "name": "Raphael Assaf",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1665472288/xp4lla0l8s2j4ysvlj9n.jpg",
    "github_url": "https://github.com/Raphassaf01",
    "linkedin_url": "https://www.linkedin.com/in/raphaël-assaf-912b501a3/",
    "contributions": "",
  },

  { "name": "Emeline Barthe",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1670512535/mwqgyaeffknprexu6jxm.jpg",
    "github_url": "https://github.com/embarthe51",
    "linkedin_url": "https://www.linkedin.com/in/emelinebarthe/",
    "contributions": "",
  },

  { "name": "Kevin Blakimé",
    "photo_url": "https://avatars.githubusercontent.com/u/115102708?v=4",
    "github_url": "https://github.com/blkevin",
    "linkedin_url": "https://www.linkedin.com/in/kevin-blakim%C3%A9-b3522a80/",
    "contributions": "",
  },

  { "name": "Élodie Bourguignon",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1670420493/a37pwmxs3vqqnela2s4u.jpg",
    "github_url": "https://github.com/ElodieBou97",
    "linkedin_url": "https://www.linkedin.com/in/%C3%A9lodie-bourguignon-a9b947236/",
    "contributions": "",
  },

  { "name": "Hugo Chipotel",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1667466121/qx0xtpaltwynlekqt2he.jpg",
    "github_url": "https://github.com/Hugochipotel",
    "linkedin_url": "",
    "contributions": "",
  },

  { "name": "Sébastien Cuthbert",
    "photo_url": "https://avatars.githubusercontent.com/u/33867598?v=4",
    "github_url": "https://github.com/Blueton23",
    "linkedin_url": "https://www.linkedin.com/in/s%C3%A9bastien-cuthbert-1a7432220/",
    "contributions": "",
  },

  { "name": "Gautier David",
    "photo_url": "https://avatars.githubusercontent.com/u/103845189?v=4",
    "github_url": "https://github.com/GautierDavid",
    "linkedin_url": "https://www.linkedin.com/in/gautierdavid93",
    "contributions": "",
  },

  { "name": "Aaron Delabays",
    "photo_url": "https://avatars.githubusercontent.com/u/115422001?v=4",
    "github_url": "https://github.com/AaronDelabays",
    "linkedin_url": "https://www.linkedin.com/in/aaron-d-59757b31/",
    "contributions": "",
  },

  { "name": "Alban de La Rochefordière",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1665117611/xlgahjdus4ba2ulnokkx.jpg",
    "github_url": "https://github.com/dlralban",
    "linkedin_url": "https://www.linkedin.com/in/dlralban/",
    "contributions": "",
  },

  { "name": "Gabriel de Monts",
    "photo_url": "https://avatars.githubusercontent.com/u/113995804?v=4",
    "github_url": "https://d26jy9fbi4q9wx.cloudfront.net/assets/alumni-bg-9744b3e860857f755558400a206e5e7c2d58bf1bf7ebf5b2ea5193e7c52cdc62.svg",
    "linkedin_url": "https://www.linkedin.com/in/gabriel-de-monts/",
    "contributions": "",
  },

  { "name": "Ahmadou Dia",
    "photo_url": "https://avatars.githubusercontent.com/u/96949079?v=4",
    "github_url": "https://github.com/ahmadia23",
    "linkedin_url": "https://www.linkedin.com/in/ahmadou-dia-47337710a/",
    "contributions": "",
  },

  { "name": "Benjamin Doberset",
    "photo_url": "https://avatars.githubusercontent.com/u/36986044?v=4",
    "github_url": "https://github.com/Benjamin-Doberset",
    "linkedin_url": "https://www.linkedin.com/in/benjamin-doberset/",
    "contributions": "",
  },

  { "name": "Gaspard Fauchille",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1665332162/j13rib7t6gt4xbiulgqv.jpg",
    "github_url": "https://github.com/Gauchille",
    "linkedin_url": "https://www.linkedin.com/in/gaspard-fauchille-29992517b",
    "contributions": "",
  },

  { "name": "Julien Ferreira",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1670845116/hrjarzvsgmszm2uubiui.jpg",
    "github_url": "https://github.com/Julien-Ferreira",
    "linkedin_url": "https://www.linkedin.com/in/julien-ferreira-89b49925a/",
    "contributions": "",
  },

  { "name": "Arthur Foucaud",
    "photo_url": "https://avatars.githubusercontent.com/u/115413024?v=4",
    "github_url": "https://github.com/ArthurFoucaud",
    "linkedin_url": "https://www.linkedin.com/in/arthur-foucaud/",
    "contributions": "",
  },

  { "name": "Pauline Gouttiere",
    "photo_url": "https://avatars.githubusercontent.com/u/106176972?v=4",
    "github_url": "https://github.com/GHPops",
    "linkedin_url": "https://www.linkedin.com/in/pauline-goutti%C3%A8re-82736162/",
    "contributions": "",
  },

  { "name": "Fabiola Hora Ordinola",
    "photo_url": "https://avatars.githubusercontent.com/u/48128895?v=4",
    "github_url": "https://github.com/fhora",
    "linkedin_url": "https://www.linkedin.com/in/fabiola-hora-ordinola",
    "contributions": "",
  },

  { "name": "Joel Irmiahu",
    "photo_url": "https://avatars.githubusercontent.com/u/115413668?v=4",
    "github_url": "https://github.com/painkex",
    "linkedin_url": "https://www.linkedin.com/in/joel-irmiahu-a3b69025a",
    "contributions": "",
  },

  { "name": "Franck Lemarchand",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1670235617/tddm97ebcaysis1s2m5s.jpg",
    "github_url": "https://github.com/FranckL93",
    "linkedin_url": "https://www.linkedin.com/in/francklemarchand/",
    "contributions": "",
  },

  { "name": "Anne Ly",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1665132136/fjc4ibutfjtc5qztzap7.jpg",
    "github_url": "https://github.com/littleannie",
    "linkedin_url": "https://www.linkedin.com/in/annely75/",
    "contributions": "",
  },

  { "name": "Gauthier Marchand",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1665326756/hvpyn5fv9pmbfadtfbme.jpg",
    "github_url": "https://github.com/garchand",
    "linkedin_url": "https://www.linkedin.com/in/gauthier-marchand/",
    "contributions": "",
  },

  { "name": "Shayneze Menegady",
    "photo_url": "https://avatars.githubusercontent.com/u/62299446?v=4",
    "github_url": "https://github.com/Shayneze",
    "linkedin_url": "https://www.linkedin.com/in/shayneze-menegady/",
    "contributions": "",
  },

  { "name": "Julien Nguyen",
    "photo_url": "https://avatars.githubusercontent.com/u/104355406?v=4",
    "github_url": "https://github.com/Naruki95",
    "linkedin_url": "https://www.linkedin.com/in/julien-nguyen-8aa749145/",
    "contributions": "",
  },

  { "name": "Eliott Norie",
    "photo_url": "https://avatars.githubusercontent.com/u/115416510?v=4",
    "github_url": "https://github.com/MyrmecoMania",
    "linkedin_url": "https://www.linkedin.com/in/eliott-norie-7b307123a/",
    "contributions": "",
  },

  { "name": "Charlotte Oswald",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1665344616/yznhsqumvxan0rupnhg4.jpg",
    "github_url": "https://github.com/CharlotteO9",
    "linkedin_url": "https://www.linkedin.com/in/charlotte-oswald-09681aa5",
    "contributions": "",
  },

  { "name": "William Passera",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1665137908/kvgo7hienojexbrywyjr.jpg",
    "github_url": "https://github.com/Will-p1275",
    "linkedin_url": "https://www.linkedin.com/in/william-passera-722ba4245/",
    "contributions": "",
  },

  { "name": "Pierre Pétel",
    "photo_url": "https://avatars.githubusercontent.com/u/112730785?v=4",
    "github_url": "https://github.com/pierreptl",
    "linkedin_url": "https://www.linkedin.com/in/pierre-petel/",
    "contributions": "",
  },

  { "name": "Hugo Pouchoux",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1665343498/vekrllkan1tqzvklgjiz.jpg",
    "github_url": "https://github.com/Pouchouxx",
    "linkedin_url": "https://www.linkedin.com/in/hugo-pouchoux",
    "contributions": "",
  },

  { "name": "Mehdi Rachid",
    "photo_url": "https://avatars.githubusercontent.com/u/115085959?v=4",
    "github_url": "https://github.com/MehdiR02",
    "linkedin_url": "https://www.linkedin.com/in/mehdi-rachid-3a42a8171",
    "contributions": "",
  },

  { "name": "Robin Rettien",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1665072255/zfsfmzn9icpxkxusegly.jpg",
    "github_url": "https://github.com/RobinRTN",
    "linkedin_url": "https://www.linkedin.com/in/robin-rettien-b30067115/",
    "contributions": "",
  },

  { "name": "Maxence Robinet",
    "photo_url": "https://avatars.githubusercontent.com/u/107369283?v=4",
    "github_url": "https://github.com/saint-james-fr",
    "linkedin_url": "https://www.linkedin.com/in/maxence-robinet-b71376135",
    "contributions": "",
  },

  { "name": "Thibaut Roland",
    "photo_url": "https://avatars.githubusercontent.com/u/115095838?v=4",
    "github_url": "https://github.com/ThibautRoland",
    "linkedin_url": "https://www.linkedin.com/in/thibaut-roland2/",
    "contributions": "",
  },

  { "name": "Anne Rubio",
    "photo_url": "https://res.cloudinary.com/wagon/image/upload/c_fill,g_face,h_200,w_200/v1665328758/wrue7f0kw1muvsalsgrj.jpg",
    "github_url": "https://github.com/AnneRubio",
    "linkedin_url": "https://www.linkedin.com/in/anne-rubio-93100-ar93/",
    "contributions": "",
  },

  { "name": "Nikolaz Stacey",
    "photo_url": "https://avatars.githubusercontent.com/u/74938003?v=4",
    "github_url": "https://github.com/nikolaz90",
    "linkedin_url": "https://www.linkedin.com/in/nikolaz-s/",
    "contributions": "",
  },

  { "name": "William Swinnen",
    "photo_url": "https://avatars.githubusercontent.com/u/115130952?v=4",
    "github_url": "https://github.com/williamswinnen",
    "linkedin_url": "https://www.linkedin.com/in/williamswinnen/",
    "contributions": "",
  },

  { "name": "Marine Wetzel",
    "photo_url": "https://avatars.githubusercontent.com/u/115414856?v=4",
    "github_url": "https://github.com/marinewtzl",
    "linkedin_url": "https://www.linkedin.com/in/marinewetzel/",
    "contributions": "",
  },
];

// classmates.forEach((classmate) => {
//   console.log(classmate.name);
//   (async () => {

//     const browser = await puppeteer.launch( {
//       // executablePath: '/usr/bin/chromium-browser',
//       headless: false,
//       // args: ["--no-sandbox"],
//       // ignoreDefaultArgs: ['--disable-extensions'],
//     } );
//     const pageGithub = await browser.newPage();
//     await pageGithub.goto(`${classmate.github_url}`);
//   })();
// });

// (async function () {
//   scrapContributions()
//   // .then(() => {console.log(classmates[0]);});
//   console.log(await classmates[0])
//   // await console.log(classmates[0]);
//   // await consoleResult();
// })();

// function scrapContributions() {
//   classmates[0].contributions =
//     (async () => {

//       const browser = await puppeteer.launch( {
//         // executablePath: '/usr/bin/chromium-browser',
//         headless: false,
//         // args: ["--no-sandbox"],
//         // ignoreDefaultArgs: ['--disable-extensions'],
//       } );
//       const pageGithub = await browser.newPage();
//       await pageGithub.goto(`${classmates[0].github_url}`);

//       let data = await pageGithub.evaluate(function() {
//         let contributions = document.querySelector('.js-yearly-contributions h2').innerText;
//         // console.log(contributions);
//         return contributions;
//       });


//       let contribution = await data.replace(/[a-zA-Z]+/gi, '');
//       // console.log(contribution);

//       return contribution
//     })();

//   console.log(classmates[0]);
// };

// function consoleResult() {
//   console.log(classmates[0]);

// };
// console.log(classmates)
// console.log(classmates[0]);
// console.log(classmates[0].contributions);
// const puppeteer = require('puppeteer');


start();

function start () {
  classmates.forEach((classmate) => {
    githubScrape(classmate)
    .then(insertContributions(classmate))
    .then(insertHtml(classmate))
    .then(console.log(classmate.contributions));
  });
};


const puppeteer = require('puppeteer');

function githubScrape(classmate) {
  return new Promise(async (resolve, reject) => {
    try {
      const browser = await puppeteer.launch( {
        userDataDir: './data',
        headless: false,
        // executablePath: '/usr/bin/chromium-browser',
        // args: ["--no-sandbox"],
        // ignoreDefaultArgs: ['--disable-extensions'],
      } );
      const pageGithub = await browser.newPage();
      await pageGithub.goto(`${classmate.github_url}`);
      await page.waitFor(5000);

      let data = await pageGithub.evaluate(function() {
        return contributions = document.querySelector('.js-yearly-contributions h2').innerText;
        // return contributions;
      });

      let result = data.replace(/[a-zA-Z]+/gi, '');
      // document.getElementById(`${classmate.name.replace(/ /g,'-')}`).innerText = contribution;
      browser.close();
      return resolve(result);
    } catch (e) {
      return reject(e);
    }
  });
}

function insertContributions(classmate) {
  classmate.contributions = githubScrape(classmate);
}

function insertHtml(classmate) {
  this.document.getElementById('card-container').insertAdjacentHTML('beforeend',
  `<div class="swiper-slide card">
      <div class="card-content">
        <div class="image">
          <img src="${classmate.photo_url}" alt="">
        </div>

        <div class="media-icons">
          <i class="fa-brands fa-linkedin"></i>
          <i class="fa-brands fa-github"></i>
        </div>

        <div class="name-profession">
          <span class="name">${classmate.name}</span>
          <span class="profession">Web Developer</span>
        </div>

        <div class="stats">
          <div class="stat-category contributions" >
            <span id="${classmate.name.replace(/ /g,'-')}" class="number green">${classmate.contributions}</span>
            <span class="text">Contributions</span>
          </div>

          <div class="stat-category rank">
            <span class="number">#1</span>
            <span class="text">rank</span>
          </div>
        </div>

        <div class="button">
          <button class="aboutMe">About Me</button>
        </div>
      </div>
    </div>`
  );
}
